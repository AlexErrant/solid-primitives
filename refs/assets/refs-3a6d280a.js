import{u as X,a as S,e as ce,h as ie,c as U,d as B,o as F,j as ue,i as R,f as D,S as P,k as ae,F as fe,g as pe,t as k,b as he}from"./index-1d815454.js";var ge=Object.defineProperty,b=(e,t)=>ge(e,"name",{value:t,configurable:!0}),J=b((e,t)=>e instanceof t||e&&e.constructor===t,"ofClass");function Y(e){return e!==null&&(typeof e=="object"||typeof e=="function")}b(Y,"isObject");function be(e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}b(be,"chain");var W=b(e=>typeof e=="function"&&!e.length?e():e,"access"),H=b(e=>Array.isArray(e)?e:[e],"asArray");function V(e,...t){return typeof e=="function"?e(...t):e}b(V,"accessWith");function de(e,t,n){const r=Array.isArray(e);let s,l=!0;return c=>{let o;if(r){o=Array(e.length);for(let p=0;p<e.length;p++)o[p]=e[p]()}else o=e();if(l)return l=!1,s=o,n;const i=X(()=>t(o,s,c));return s=o,i}}b(de,"defer");var ve=Object.entries,me=Object.keys,we=b(()=>{let e=[];const t=b(()=>e=[],"clear");return{push:(...n)=>e.push(...n),execute(n,r,s,l){e.forEach(c=>c(n,r,s,l)),t()},clear:t}},"createCallbackStack");function ye(e){let t=0,n;return(...r)=>{n=r,t++,queueMicrotask(()=>--t===0&&e(...n))}}b(ye,"createMicrotask");function $e(e){const t={...e},n={},r=new Map,s=b(o=>{const i=r.get(o);if(i)return i[0]();const p=S(t[o],{name:typeof o=="string"?o:void 0});return r.set(o,p),delete t[o],p[0]()},"getValue"),l=b((o,i)=>{const p=r.get(o);if(p)return p[1](i);o in t&&(t[o]=V(i,[t[o]]))},"setValue");for(const o of me(e))n[o]=void 0,Object.defineProperty(n,o,{get:s.bind(void 0,o)});return[n,b((o,i)=>(Y(o)?X(()=>{ce(()=>{for(const[p,N]of ve(V(o,n)))l(p,()=>N)})}):l(o,i),n),"setter")]}b($e,"createStaticStore");function _e(e,t,n,r){const s=e.length,l=t.length;let c=0;if(!l){for(;c<s;c++)n(e[c]);return}if(!s){for(;c<l;c++)r(t[c]);return}for(;c<l&&t[c]===e[c];c++);let o,i;t=t.slice(c),e=e.slice(c);for(o of t)e.includes(o)||r(o);for(i of e)t.includes(i)||n(i)}b(_e,"handleDiffArray");var Se=Object.defineProperty,y=(e,t)=>Se(e,"name",{value:t,configurable:!0}),ke=y(e=>e.slice(),"shallowArrayCopy"),xe=y(e=>Object.assign({},e),"shallowObjectCopy"),Ce=y((e,t)=>{const n=ke(e);return t(n),n},"withArrayCopy");function Ee(...e){let t=0;for(const n of e)t+=n;return t}y(Ee,"add");function Ae(e,...t){let n=e;for(const r of t)n=n[r];return n}y(Ae,"get");function Oe(e,...t){const n=typeof t[0]=="string"?[t]:t,r=xe(e);let s=[];for(let l=0;l<n.length;l++){const c=n[l];s.push({});for(const o of c)s[l][o]=r[o],delete r[o]}return[...s,r]}y(Oe,"split");function je(...e){const t={};for(const n of e)Object.assign(t,n);return t}y(je,"merge");function Ne(e,t){const n=e.filter(t);return n.removed=e.length-n.length,n}y(Ne,"filter");var De=y((e,t,n=0,...r)=>Ce(e,s=>s.splice(t,n,...r)),"splice");function Ie(...e){const t=[];for(const n in e)Array.isArray(e[n])?t.push(...e[n]):t.push(e[n]);return t}y(Ie,"concat");var Re=y((e,t,...n)=>{const r=e.indexOf(t);return De(e,r,1,...n)},"remove"),Me=y((e,...t)=>{const n=[];for(let r=0;r<e.length;r++){const s=e[r],l=t.indexOf(s);l!==-1?t.splice(l,1):n.push(s)}return n},"removeItems"),Le=y((e,...t)=>t.length===1?e.filter(n=>J(n,t[0])):e.filter(n=>n&&t.some(r=>J(n,r))),"filterInstance");let Te=se;const L=1,M=2,Pe={owned:null,cleanups:null,context:null,owner:null};var v=null;let j=null,m=null,w=null,E=null,G=0;function Z(e,t){const n=m,r=v,s=e.length===0,l=s?Pe:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},c=s?e:()=>e(()=>ee(()=>T(l)));v=l,m=null;try{return I(c,!0)}finally{m=n,v=r}}function ee(e){if(m===null)return e();const t=m;m=null;try{return e()}finally{m=t}}function te(e){return v===null||(v.cleanups===null?v.cleanups=[e]:v.cleanups.push(e)),e}function ne(){return v}function Ue(e,t){const n=v,r=m;v=e,m=null;try{return I(t,!0)}catch(s){K(s)}finally{v=n,m=r}}function We(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&I(()=>{for(let s=0;s<e.observers.length;s+=1){const l=e.observers[s],c=j&&j.running;c&&j.disposed.has(l),(c&&!l.tState||!c&&!l.state)&&(l.pure?w.push(l):E.push(l),l.observers&&le(l)),c||(l.state=L)}if(w.length>1e6)throw w=[],new Error},!1)),t}function Ve(e){if(!e.fn)return;T(e);const t=v,n=m,r=G;m=v=e,qe(e,e.value,r),m=n,v=t}function qe(e,t,n){let r;try{r=e.fn(t)}catch(s){e.pure&&(e.state=L,e.owned&&e.owned.forEach(T),e.owned=null),K(s)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?We(e,r):e.value=r,e.updatedAt=n)}function re(e){const t=j;if(e.state===0||t)return;if(e.state===M||t)return q(e);if(e.suspense&&ee(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<G);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===L||t)Ve(e);else if(e.state===M||t){const s=w;w=null,I(()=>q(e,n[0]),!1),w=s}}function I(e,t){if(w)return e();let n=!1;t||(w=[]),E?n=!0:E=[],G++;try{const r=e();return He(n),r}catch(r){n||(E=null),w=null,K(r)}}function He(e){if(w&&(se(w),w=null),e)return;const t=E;E=null,t.length&&I(()=>Te(t),!1)}function se(e){for(let t=0;t<e.length;t++)re(e[t])}function q(e,t){const n=j;e.state=0;for(let r=0;r<e.sources.length;r+=1){const s=e.sources[r];s.sources&&(s.state===L||n?s!==t&&re(s):(s.state===M||n)&&q(s,t))}}function le(e){const t=j;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=M,r.pure?w.push(r):E.push(r),r.observers&&le(r))}}function T(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const l=s.pop(),c=n.observerSlots.pop();r<s.length&&(l.sourceSlots[c]=r,s[r]=l,n.observerSlots[r]=c)}}if(e.owned){for(t=0;t<e.owned.length;t++)T(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Ge(e){return e instanceof Error||typeof e=="string"?e:new Error("Unknown error")}function K(e){throw e=Ge(e),e}var Ke=Object.defineProperty,Q=(e,t)=>Ke(e,"name",{value:t,configurable:!0});function z(e,...t){return t.length===0&&(t=[ne()]),Z(n=>(H(W(t)).forEach(r=>r&&Ue(r,te.bind(void 0,n))),e(n)),t[0])}Q(z,"createSubRoot");function Qe(e,...t){return z(n=>(e(n),n),...t)}Q(Qe,"createDisposable");function ze(e){let t=0,n,r;return()=>(r||Z(s=>{n=e(s),r=s}),t++,ne()&&te(()=>{t--,queueMicrotask(()=>{t||!r||(r(),r=void 0,n=void 0)})}),n)}Q(ze,"createSharedRoot");const Be=(e,t)=>{const n=e.indexOf(t);e.splice(n,1)};function Fe(e,...t){return U(()=>Le(H(e()),...t.length?t:[Element]))}const Je=(e,t)=>{ie(()=>t()(e))};function Xe(e,t){let n=[];const r=new Set,s=t.length>1?new Map:void 0,l=ue(),[c,o]=S([]);B(F(e,A=>{const{length:O}=n,g=H(A).slice();if(!O)return o(n=g);for(let d=0,f=0;d<O;){const u=n[d];if(g.includes(u))d++,f++;else if(r.has(u)){const a=n.indexOf(g[f]);a!==-1&&a<=d?f++:(g.splice(f,0,u),s?.get(u)?.(f),d++)}else N(g,u,d),d++}o(n=g)}));let i=[];const p=()=>{i.length&&(o(A=>Me(A,...i)),i=[])};function N(A,O,g){z(d=>{let f,u;if(s){const[h,$]=S(g),x=t(O,h),C=W(x);if(!C)return d();s.set(C,$),f=x,u=C}else{const h=t(O),$=W(h);if(!$)return d();f=h,u=$}r.add(u),A.splice(g,0,u);let a=u;B(F(f,h=>{if(r.delete(a),s){const $=s.get(a);if(s.delete(a),h)$&&s.set(h,$);else{const x=c();for(g=x.indexOf(a);g<x.length;g++)s.get(x[g])?.(C=>--C)}}if(!h)return Be(n,a),i.push(a),queueMicrotask(p),d();r.add(h),o($=>Re($,a,h)),a=h},{defer:!0}))},l)}return c}const Ye=k('<div class="absolute bg-black"></div>'),Ze=k("<p>Elements count: </p>"),et=k('<div class="wrapper-h flex-wrap"><button class="btn">+ 1</button><button class="btn">- 1</button><button class="btn">toggle 0</button><button class="btn">toggle 1</button><button class="btn">toggle 2 & 3</button><button class="btn">toggle wrapper</button><button class="btn">clear</button></div>'),tt=k("<p>Hello</p>"),nt=k('<div class="node">ID 1</div>'),rt=k('<div class="node">ID 2</div>'),st=k('<div class="node">ID 3</div>'),lt=k('<div class="wrapper-h flex-wrap"></div>'),ot=k('<div class="node">ID 0</div>'),ct=k('<div class="node bg-yellow-600">.</div>'),it=e=>{const t=he(()=>e.children),n=Fe(t,HTMLElement),r=we();return e.getClear?.(r.execute),Xe(n,(l,c)=>{const[o,i]=S(l);return console.log("REMOVED",c()),r.push(()=>i(void 0)),l.style.filter="grayscale(100%)",l.style.position="relative",l.appendChild((()=>{const p=Ye.cloneNode(!0);return R(p,c),p})()),l.addEventListener("click",()=>i(void 0)),o})},at=()=>{const[e,t]=S(!1),[n,r]=S(!1),[s,l]=S(!0),[c,o]=S(!0),[i,p]=S(5),[N,A]=S([]),[O,g]=S(0);setInterval(()=>g(f=>++f),1e3);let d;return[(()=>{const f=Ze.cloneNode(!0);return f.firstChild,R(f,()=>N().length,null),f})(),(()=>{const f=et.cloneNode(!0),u=f.firstChild,a=u.nextSibling,h=a.nextSibling,$=h.nextSibling,x=$.nextSibling,C=x.nextSibling,oe=C.nextSibling;return u.$$click=()=>p(_=>++_),a.$$click=()=>p(_=>--_),h.$$click=()=>t(_=>!_),$.$$click=()=>r(_=>!_),x.$$click=()=>l(_=>!_),C.$$click=()=>o(_=>!_),oe.$$click=()=>d(),f})(),(()=>{const f=lt.cloneNode(!0);return R(f,D(it,{getClear:u=>d=u,get children(){return D(P,{get when(){return c()},get children(){return[tt.cloneNode(!0),"World",U(()=>U(()=>!!e())()&&ot.cloneNode(!0)),D(P,{get when(){return n()},get children(){return nt.cloneNode(!0)}}),D(P,{get when(){return s()},get children(){return[(()=>{const u=rt.cloneNode(!0);return ae(Je,u,()=>a=>console.log("Unmounted",a)),u})(),st.cloneNode(!0)]}}),D(fe,{get each(){return Array.from({length:i()},(u,a)=>a)},children:u=>(()=>{const a=ct.cloneNode(!0),h=a.firstChild;return R(a,u+1,h),a})()})]}})}})),f})()]};pe(["click"]);export{at as default};
